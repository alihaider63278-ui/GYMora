<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GYMora ‚Äî Personal Fitness Hub</title>

<!-- Chart.js CDN for progress charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<style>
  /* Basic reset & variables */
  :root{
    --bg: #0f1724;            /* dark background base */
    --card: #0b1220;
    --muted: #94a3b8;
    --accent: linear-gradient(90deg,#6b5bff,#ff7bac);
    --accent-solid: #7b66ff;
    --glass: rgba(255,255,255,0.03);
    --radius: 14px;
    --outline: 2px;
    --success: #22c55e;
  }
  :root.light{
    --bg: #f6f8fb;
    --card: #ffffff;
    --muted: #475569;
    --accent-solid: #6b5bff;
    --glass: rgba(0,0,0,0.03);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    background:var(--bg); color: #e6eef8;-webkit-font-smoothing:antialiased}
  body.light{color:#0b1220}
  /* app shell */
  .app{
    display:grid;
    grid-template-columns: 72px 1fr;
    min-height:100vh;
  }
  /* SIDEBAR */
  .sidebar{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.03));
    padding:18px 10px;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:14px;
    border-right:1px solid rgba(255,255,255,0.03);
  }
  .logo{
    width:48px;height:48px;border-radius:12px;
    display:flex;align-items:center;justify-content:center;
    font-weight:800;font-size:18px;
    background:var(--accent-solid);
    color:white; box-shadow:0 6px 18px rgba(123,102,255,0.18);
    transform:translateY(0); transition:all .2s;
  }
  .logo:active{transform:translateY(2px) scale(.98)}
  .navbtn{
    width:48px;height:48px;border-radius:12px;border:var(--outline) solid rgba(255,255,255,0.03);
    background:transparent;color:var(--muted);display:flex;align-items:center;justify-content:center;
    cursor:pointer; transition:transform .12s, background .18s, color .18s; font-size:14px;
  }
  .navbtn:hover{transform:translateY(-4px); color:white; background:var(--glass)}
  .navbtn.active{background:linear-gradient(180deg, rgba(123,102,255,0.14), rgba(255,124,160,0.06)); color:white}
  .sidebar .spacer{flex:1}
  /* TOPBAR + CONTENT */
  .main{
    padding:14px;
  }
  .topbar{
    display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px;
  }
  .search{
    flex:1;background:var(--card);padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,0.02);
    display:flex;gap:8px;align-items:center;min-width:0;
  }
  .search input{flex:1;border:0;background:transparent;color:inherit;outline:none}
  .outline-btn{
    display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;
    border:var(--outline) solid var(--accent-solid); background:transparent;color:inherit;cursor:pointer;
    transition:transform .12s, box-shadow .12s;
  }
  .outline-btn:active{transform:scale(.98)}
  .outline-btn .dot{width:10px;height:10px;border-radius:3px;background:linear-gradient(90deg,#6b5bff,#ff7bac)}
  .card{
    background:var(--card); border-radius:var(--radius); padding:14px; box-shadow: 0 6px 18px rgba(2,6,23,0.6);
    margin-bottom:14px; border:1px solid rgba(255,255,255,0.02);
  }
  .grid{
    display:grid;grid-template-columns:repeat(12,1fr);gap:14px;
  }
  .col-4{grid-column:span 4}
  .col-8{grid-column:span 8}
  .col-6{grid-column:span 6}
  .col-12{grid-column:span 12}
  h1,h2{margin:0 0 8px 0}
  p{margin:0;color:var(--muted)}
  /* small utilities */
  .muted{color:var(--muted);font-size:13px}
  .kbd{padding:6px 10px;border-radius:8px;background:rgba(0,0,0,0.08);font-weight:600}
  /* responsive */
  @media (max-width:900px){
    .app{grid-template-columns: 64px 1fr}
    .grid{grid-template-columns:repeat(6,1fr)}
    .col-8{grid-column:span 6}
    .col-4{grid-column:span 6}
  }
  @media (max-width:640px){
    .app{grid-template-columns: 56px 1fr}
    .grid{grid-template-columns:repeat(4,1fr)}
    .col-6{grid-column:span 4}
    .col-4{grid-column:span 4}
  }

  /* Form styles */
  label{display:block;margin-top:8px;font-size:13px;color:var(--muted)}
  input[type="number"], input[type="text"], select, textarea{
    width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;
  }
  .btn-primary{
    display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:none;background:var(--accent-solid);color:white;
    cursor:pointer; box-shadow: 0 8px 30px rgba(99,73,255,0.14); transition:transform .12s;
  }
  .btn-primary:active{transform:translateY(2px) scale(.995)}
  .mini{padding:8px 10px;font-size:13px;border-radius:10px}
  .row{display:flex;gap:8px;flex-wrap:wrap}
  .small{font-size:13px;color:var(--muted)}

  /* toast */
  .toast{position:fixed;right:18px;bottom:18px;background:var(--card);padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 12px 36px rgba(2,6,23,0.6)}
  /* outlined animated click effect for .outline-btn already present */
  /* chart card */
  .chart-wrap{height:210px}
  /* ai chat */
  #chatBox{height:220px;overflow:auto;padding:10px;border-radius:10px;background:rgba(0,0,0,0.03);margin-bottom:8px}
  .msg{padding:8px 10px;border-radius:10px;margin-bottom:8px;display:inline-block;max-width:86%}
  .msg.user{background:linear-gradient(90deg,#6b5bff22,#ff7bac22);align-self:flex-end}
  .msg.bot{background:rgba(255,255,255,0.02)}
  /* tracker table */
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px;border-bottom:1px dashed rgba(255,255,255,0.03);text-align:left}
  .muted-2{color:rgba(255,255,255,0.55);font-size:12px}

  /* small animation for icons */
  .pulse{animation:pulse 1.8s infinite}
  @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}

  /* nice rounded inputs focus */
  input:focus,select:focus,textarea:focus{outline:none;box-shadow:0 6px 20px rgba(123,102,255,0.06);border-color:rgba(123,102,255,0.4)}
</style>
</head>
<body>

<div id="app" class="app">
  <!-- SIDEBAR -->
  <aside class="sidebar" aria-label="Main navigation">
    <div class="logo" title="GYMora">GYM</div>

    <button class="navbtn active" data-page="dashboard" title="Dashboard" aria-label="Dashboard" onclick="navTo(event)">üè†</button>
    <button class="navbtn" data-page="calc" title="Calculators" onclick="navTo(event)">‚öñÔ∏è</button>
    <button class="navbtn" data-page="bot" title="AI Bot" onclick="navTo(event)">ü§ñ</button>
    <button class="navbtn" data-page="workouts" title="Workouts" onclick="navTo(event)">üèãÔ∏è</button>
    <button class="navbtn" data-page="timer" title="Timer" onclick="navTo(event)">‚è±Ô∏è</button>
    <div class="spacer"></div>
    <button class="navbtn" id="themeToggle" title="Toggle theme" onclick="toggleTheme()">üåô</button>
    <button class="navbtn" title="Export" onclick="exportData()">‚¨áÔ∏è</button>
    <button class="navbtn" title="Import" onclick="importData()">‚¨ÜÔ∏è</button>
  </aside>

  <!-- MAIN -->
  <main class="main" role="main">
    <div class="topbar">
      <div class="search card" style="max-width:760px">
        <svg width="18" height="18" viewBox="0 0 24 24" style="opacity:.7"><path fill="currentColor" d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z"></path></svg>
        <input id="quickSearch" placeholder="Search exercises, diets, bot..." onkeydown="if(event.key==='Enter'){quickSearch()}">
        <button class="outline-btn" onclick="quickSearch()"><span class="dot"></span>Search</button>
      </div>

      <div style="display:flex;gap:8px;align-items:center">
        <div class="small muted">Welcome, <strong id="userName">User</strong></div>
        <button class="outline-btn" onclick="openAssistant()"><span style="font-weight:700">AI</span> Bot</button>
        <button class="btn-primary" onclick="startQuickWorkout()">Start Quick</button>
      </div>
    </div>

    <!-- PAGES -->
    <section id="dashboard" class="page">
      <div class="grid">
        <div class="card col-8">
          <h1>Daily Plan</h1>
          <p class="small muted">Auto-generated based on your profile and goals</p>

          <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap">
            <div style="flex:1;min-width:220px" class="card">
              <h2>Today's Workout</h2>
              <div id="todayWorkout">Loading...</div>
              <div style="margin-top:8px" class="row">
                <button class="outline-btn mini" onclick="completeWorkout()">Mark Complete</button>
                <button class="outline-btn mini" onclick="logWorkoutManually()">Log Manually</button>
              </div>
            </div>

            <div style="flex:1;min-width:220px" class="card">
              <h2>Today's Diet</h2>
              <div id="todayDiet">Loading...</div>
            </div>

            <div style="min-width:140px" class="card">
              <h2>Quick Stats</h2>
              <p class="small"><strong id="statBMI">BMI: ‚Äî</strong></p>
              <p class="small"><strong id="statCalories">Calories: ‚Äî</strong></p>
              <p class="small"><strong id="statProtein">Protein: ‚Äî</strong></p>
            </div>
          </div>

          <div style="margin-top:14px" class="card">
            <h2>Progress</h2>
            <div class="chart-wrap">
              <canvas id="weightChart"></canvas>
            </div>
            <div class="small muted" style="margin-top:8px">Log weight below to view chart</div>
            <div style="display:flex;gap:8px;margin-top:8px">
              <input type="number" id="logWeight" placeholder="Weight (kg)">
              <button class="outline-btn" onclick="addWeight()">Log</button>
            </div>
          </div>
        </div>

        <div class="col-4">
          <div class="card">
            <h2>Protein Guide</h2>
            <p class="small muted">What to eat for protein</p>
            <ul id="proteinList" style="margin-top:8px"></ul>
          </div>

          <div class="card">
            <h2>Stopwatch</h2>
            <div id="stopwatchDisplay" style="font-size:20px">00:00:00</div>
            <div style="margin-top:8px" class="row">
              <button class="outline-btn mini" onclick="swStart()">Start</button>
              <button class="outline-btn mini" onclick="swStop()">Stop</button>
              <button class="outline-btn mini" onclick="swReset()">Reset</button>
            </div>
          </div>

          <div class="card">
            <h2>AI Tip</h2>
            <p id="aiTip">Ask the AI Bot about exercise form, diet swaps, or how to progress.</p>
            <div style="margin-top:8px" class="small muted">Tip updates every day</div>
          </div>
        </div>

      </div>
    </section>

    <section id="calc" class="page" style="display:none;">
      <div class="grid">
        <div class="card col-6">
          <h2>BMI & Body</h2>
          <label>Height (cm)</label><input id="height" type="number" placeholder="170">
          <label>Weight (kg)</label><input id="weight" type="number" placeholder="70">
          <label>Age</label><input id="age" type="number" placeholder="25">
          <label>Gender</label>
          <select id="gender"><option value="male">Male</option><option value="female">Female</option></select>
          <label>Activity</label>
          <select id="activity">
            <option value="1.2">Sedentary</option>
            <option value="1.375">Light</option>
            <option value="1.55">Moderate</option>
            <option value="1.725">Active</option>
            <option value="1.9">Very Active</option>
          </select>
          <div style="margin-top:10px" class="row">
            <button class="btn-primary" onclick="calculateAll()">Calculate</button>
            <button class="outline-btn" onclick="saveProfile()">Save</button>
          </div>
          <div style="margin-top:10px" id="calcResult"></div>
        </div>

        <div class="card col-6">
          <h2>Macro Helper</h2>
          <p class="small muted">Adjust percentages if you want</p>
          <label>Protein %</label><input id="macroProtein" type="number" value="30">
          <label>Fat %</label><input id="macroFat" type="number" value="25">
          <label>Carbs %</label><input id="macroCarb" type="number" value="45">
          <div style="margin-top:10px" class="row">
            <button class="outline-btn" onclick="calcMacros()">Get Macros</button>
          </div>
          <div style="margin-top:10px" id="macroResult"></div>
        </div>

        <div class="card col-12">
          <h2>Protein Sources</h2>
          <div id="proteinSources" class="row"></div>
        </div>
      </div>
    </section>

    <section id="bot" class="page" style="display:none;">
      <div class="card" style="display:flex;flex-direction:column">
        <h2>GYMora AI Bot</h2>
        <div id="chatBox"></div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <input id="botInput" placeholder="Ask about workout, diet, supplements..." onkeydown="if(event.key==='Enter'){botSend()}">
          <button class="outline-btn" onclick="botSend()">Send</button>
        </div>
        <div class="small muted" style="margin-top:8px">AI is local rule-based assistant for now ‚Äî detailed custom plans available soon.</div>
      </div>
    </section>

    <section id="workouts" class="page" style="display:none;">
      <div class="grid">
        <div class="card col-6">
          <h2>Workout Library</h2>
          <p class="small muted">Select a preset or create your own</p>
          <select id="preset">
            <option value="beginner">Full Body - Beginner</option>
            <option value="intermediate">Upper/Lower - Intermediate</option>
            <option value="advanced">Split - Advanced</option>
          </select>
          <div style="margin-top:8px" class="row">
            <button class="btn-primary" onclick="generatePreset()">Generate</button>
            <button class="outline-btn" onclick="savePreset()">Save Preset</button>
          </div>

          <div id="presetView" style="margin-top:12px"></div>
        </div>

        <div class="card col-6">
          <h2>Workout Log</h2>
          <table id="logTable"><thead><tr><th>Date</th><th>Workout</th><th>Notes</th></tr></thead><tbody></tbody></table>
          <div style="margin-top:8px" class="row">
            <input id="logNote" placeholder="Quick note">
            <button class="outline-btn" onclick="addLog()">Add Log</button>
          </div>
        </div>
      </div>
    </section>

    <section id="timer" class="page" style="display:none;">
      <div class="grid">
        <div class="card col-6">
          <h2>Stopwatch</h2>
          <div id="sw" style="font-size:28px">00:00:00</div>
          <div style="margin-top:8px" class="row">
            <button class="btn-primary" onclick="swStart()">Start</button>
            <button class="outline-btn" onclick="swStop()">Stop</button>
            <button class="outline-btn" onclick="swReset()">Reset</button>
          </div>
        </div>

        <div class="card col-6">
          <h2>Interval Timer (HIIT)</h2>
          <label>Rounds</label><input id="hiitRounds" type="number" value="6">
          <label>Work (sec)</label><input id="hiitWork" type="number" value="30">
          <label>Rest (sec)</label><input id="hiitRest" type="number" value="15">
          <div style="margin-top:8px" class="row">
            <button class="btn-primary" onclick="startHIIT()">Start HIIT</button>
            <button class="outline-btn" onclick="stopHIIT()">Stop</button>
          </div>
          <div style="margin-top:12px" id="hiitDisplay"></div>
        </div>
      </div>
    </section>

  </main>
</div>

<!-- Toast container -->
<div id="toastRoot" style="position:fixed;right:18px;bottom:18px"></div>

<script>
/* ---------------------------
   Utilities & localStorage
   --------------------------- */
const storage = {
  get(key, fallback){
    try{ const v = localStorage.getItem(key); return v?JSON.parse(v):fallback }catch(e){return fallback}
  },
  set(key,val){ localStorage.setItem(key,JSON.stringify(val)) }
}

/* initial user/profile */
let profile = storage.get('gymora_profile', {
  name:'Ali', age:25, gender:'male', height:170, weight:70, activity:1.55, goal:'maintain'
});
document.getElementById('userName').innerText = profile.name || 'User';

/* theme */
(function initTheme(){
  const prefer = localStorage.getItem('gymora_theme');
  if(prefer === 'light'){ document.body.classList.add('light'); document.documentElement.classList.add('light'); }
  updateThemeButton();
})();
function toggleTheme(){
  document.body.classList.toggle('light');
  document.documentElement.classList.toggle('light');
  localStorage.setItem('gymora_theme', document.body.classList.contains('light') ? 'light' : 'dark');
  updateThemeButton(); toast('Theme changed');
}
function updateThemeButton(){
  const t = document.body.classList.contains('light') ? 'üåû' : 'üåô';
  document.getElementById('themeToggle').innerText = t;
}

/* pages nav */
function navTo(e){
  const btn = (e.target.closest) ? e.target.closest('button') : e.target;
  document.querySelectorAll('.navbtn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  const page = btn.dataset.page;
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  document.getElementById(page).style.display='block';
}

/* quick search */
function quickSearch(){
  const q = document.getElementById('quickSearch').value.toLowerCase();
  if(!q) return toast('Type something to search');
  // simple routing: if includes "bot" go to bot, "calc" to calc etc
  if(q.includes('bot') || q.includes('ai')){ document.querySelector('[data-page="bot"]').click(); return }
  if(q.includes('bmi')||q.includes('calorie')||q.includes('macro')){ document.querySelector('[data-page="calc"]').click(); return }
  if(q.includes('timer')||q.includes('hiit')||q.includes('stopwatch')){ document.querySelector('[data-page="timer"]').click(); return }
  toast('No direct match ‚Äî try asking the bot');
}

/* toast */
function toast(txt, ms=2200){
  const root = document.getElementById('toastRoot');
  const d = document.createElement('div');
  d.className='toast';
  d.innerText=txt;
  root.appendChild(d);
  setTimeout(()=>{ d.style.opacity=0; d.style.transform='translateY(10px)'; }, ms-300);
  setTimeout(()=>root.removeChild(d), ms);
}

/* ---------------------------
   Calculators: BMI, BMR, Macros
   --------------------------- */
function calculateAll(){
  const h = Number(document.getElementById('height').value) || profile.height;
  const w = Number(document.getElementById('weight').value) || profile.weight;
  const age = Number(document.getElementById('age').value) || profile.age;
  const gender = document.getElementById('gender').value || profile.gender;
  const activity = Number(document.getElementById('activity').value) || profile.activity;

  const bmi = (w/((h/100)*(h/100))).toFixed(1);
  let bmr;
  if(gender==='male') bmr = 10*w + 6.25*h - 5*age + 5;
  else bmr = 10*w + 6.25*h - 5*age - 161;
  const maintenance = Math.round(bmr * activity);

  document.getElementById('calcResult').innerHTML =
    `<p class="small">BMI: <strong>${bmi}</strong> ‚Äî ${bmiInterpret(bmi)}</p>
     <p class="small">BMR: <strong>${Math.round(bmr)}</strong> kcal/day</p>
     <p class="small">Maintenance: <strong>${maintenance}</strong> kcal/day</p>`;

  // update stats on dashboard
  document.getElementById('statBMI').innerText = `BMI: ${bmi}`;
  document.getElementById('statCalories').innerText = `Calories: ${maintenance}`;
  // update macros defaults
  profile.height=h; profile.weight=w; profile.age=age; profile.activity=activity; profile.gender=gender;
  storage.set('gymora_prof
